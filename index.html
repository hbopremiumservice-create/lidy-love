<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a0a14">
    <title>Lidy üíã | 14 de Febrero</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: fixed;
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #0a0005 0%, #1a0514 25%, #2d0a28 50%, #1a0514 75%, #0a0005 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: #fff;
            position: relative;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Canvas para part√≠culas */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        /* Contenedor principal */
        .container {
            position: relative;
            width: 100%;
            height: 100dvh;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            overflow: hidden;
        }

        /* Secciones */
        .section {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease, filter 0.8s ease;
            filter: blur(20px);
        }

        .section.active {
            opacity: 1;
            pointer-events: all;
            filter: blur(0);
        }

        /* Textos */
        h1 {
            font-size: clamp(2.5rem, 10vw, 5rem);
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 30px rgba(255, 105, 180, 0.8), 0 0 60px rgba(255, 105, 180, 0.4);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .subtitle {
            font-size: clamp(1.2rem, 5vw, 2rem);
            text-align: center;
            margin-bottom: 15px;
            opacity: 0;
            animation: fadeInUp 1s ease forwards;
            animation-delay: 0.5s;
        }

        .description {
            font-size: clamp(1rem, 4vw, 1.5rem);
            text-align: center;
            margin-bottom: 30px;
            opacity: 0;
            animation: fadeInUp 1s ease forwards;
            animation-delay: 1s;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
            from {
                opacity: 0;
                transform: translateY(30px);
            }
        }

        /* Botones */
        .btn {
            padding: 18px 45px;
            font-size: clamp(1.1rem, 4vw, 1.5rem);
            font-weight: 600;
            background: linear-gradient(135deg, #ff1493, #c71585);
            border: none;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            box-shadow: 0 0 30px rgba(255, 20, 147, 0.6), 0 10px 30px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            opacity: 0;
            animation: fadeInUp 1s ease forwards;
            animation-delay: 1.5s;
            touch-action: manipulation;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .btn:hover::before {
            opacity: 1;
        }

        /* Caja de regalo */
        .gift-box {
            width: 200px;
            height: 200px;
            margin: 30px auto;
            position: relative;
            cursor: pointer;
            transition: transform 0.5s ease;
        }

        .gift-box:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .gift-box-container {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .gift-box.opening .gift-box-container {
            transform: rotateY(720deg) scale(1.5);
        }

        .gift-base {
            width: 160px;
            height: 120px;
            background: linear-gradient(135deg, #ff69b4, #ff1493);
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(255, 20, 147, 0.6);
        }

        .gift-lid {
            width: 180px;
            height: 40px;
            background: linear-gradient(135deg, #ff1493, #c71585);
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 10px 10px 5px 5px;
            box-shadow: 0 5px 20px rgba(199, 21, 133, 0.6);
        }

        .gift-ribbon-v {
            width: 30px;
            height: 100%;
            background: linear-gradient(to right, #ffd700, #ffed4e);
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        }

        .gift-ribbon-h {
            width: 100%;
            height: 30px;
            background: linear-gradient(to bottom, #ffd700, #ffed4e);
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        }

        .gift-bow {
            width: 60px;
            height: 40px;
            background: #ffd700;
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 50% 50% 0 0;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.9);
        }

        .gift-bow::before,
        .gift-bow::after {
            content: '';
            width: 35px;
            height: 35px;
            background: #ffd700;
            position: absolute;
            border-radius: 50%;
            top: 5px;
        }

        .gift-bow::before {
            left: -25px;
        }

        .gift-bow::after {
            right: -25px;
        }

        /* Contenido de regalo */
        .gift-content {
            text-align: center;
            max-width: 90%;
            opacity: 0;
            transform: scale(0.8);
            transition: all 1s ease;
        }

        .gift-content.revealed {
            opacity: 1;
            transform: scale(1);
        }

        .gift-content h2 {
            font-size: clamp(1.8rem, 6vw, 3rem);
            margin-bottom: 20px;
            color: #ff69b4;
            text-shadow: 0 0 20px rgba(255, 105, 180, 0.8);
        }

        .gift-content p {
            font-size: clamp(1.1rem, 4vw, 1.8rem);
            line-height: 1.6;
            margin-bottom: 30px;
            font-style: italic;
        }

        /* Barra de progreso */
        .progress-bar {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 100;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: #ff1493;
            box-shadow: 0 0 15px rgba(255, 20, 147, 0.8);
            transform: scale(1.3);
        }

        /* Controles de audio */
        .audio-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: rgba(255, 20, 147, 0.9);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 20, 147, 0.6);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .audio-control:active {
            transform: scale(0.9);
        }

        /* Mini Juego */
        .game-container {
            width: 100%;
            max-width: 500px;
            height: 60vh;
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            border: 2px solid rgba(255, 105, 180, 0.3);
            overflow: hidden;
        }

        .game-stats {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-around;
            font-size: clamp(1.2rem, 5vw, 1.8rem);
            font-weight: 600;
            z-index: 10;
            padding: 0 20px;
        }

        .game-stat {
            background: rgba(255, 20, 147, 0.8);
            padding: 10px 20px;
            border-radius: 15px;
            box-shadow: 0 0 15px rgba(255, 20, 147, 0.6);
        }

        .heart-target {
            position: absolute;
            font-size: 40px;
            cursor: pointer;
            transition: transform 0.1s ease;
            animation: floatHeart 3s ease-in-out infinite;
            z-index: 5;
        }

        @keyframes floatHeart {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        .heart-target:active {
            transform: scale(1.5);
        }

        .game-result {
            text-align: center;
            font-size: clamp(1.5rem, 6vw, 2.5rem);
            margin: 30px 0;
        }

        /* Efectos especiales */
        @keyframes explode {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(3);
                opacity: 0;
            }
        }

        .heart-explosion {
            position: fixed;
            pointer-events: none;
            animation: explode 0.6s ease-out forwards;
            z-index: 1000;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .gift-box {
                width: 150px;
                height: 150px;
            }
            
            .gift-base {
                width: 120px;
                height: 90px;
            }
            
            .gift-lid {
                width: 135px;
                height: 30px;
                top: 45px;
            }
        }

        /* Loading indicator */
        .audio-status {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 30px 50px;
            border-radius: 20px;
            font-size: 1.2rem;
            z-index: 2000;
            display: none;
            text-align: center;
            border: 2px solid #ff1493;
        }
    </style>
</head>
<body>
    <!-- Canvas para part√≠culas -->
    <canvas id="particles"></canvas>

    <!-- Indicador de estado de audio -->
    <div id="audioStatus" class="audio-status"></div>

    <!-- Barra de progreso -->
    <div class="progress-bar" id="progressBar"></div>

    <!-- Control de audio -->
    <button class="audio-control" id="audioControl" style="display: none;">
        üîä
    </button>

    <!-- Contenedor principal -->
    <div class="container">
        <!-- Secci√≥n 0: Inicio -->
        <div class="section active" id="section0">
            <h1>Lidy üíã</h1>
            <div class="subtitle">Este 14 de febrero‚Ä¶</div>
            <div class="description">Es nuestro d√≠a.</div>
            <button class="btn" onclick="startExperience()">Toca aqu√≠ para iniciar üî•</button>
        </div>

        <!-- Secciones de regalos (1-10) -->
        <div class="section" id="section1">
            <div class="gift-box" onclick="openGift(1)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content1">
                <h2>üç´ Chocolate Tur√≠n Masterpieces</h2>
                <p>"Se ven buenos‚Ä¶ pero t√∫ te ves mejor."</p>
                <button class="btn" onclick="nextSection(2)">Siguiente ‚ûú</button>
            </div>
        </div>

        <div class="section" id="section2">
            <div class="gift-box" onclick="openGift(2)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content2">
                <h2>üëó Pijama</h2>
                <p>"Me encanta verte c√≥moda‚Ä¶ aunque prefiero cuando dura poquito."</p>
                <button class="btn" onclick="nextSection(3)">Siguiente ‚ûú</button>
            </div>
        </div>

        <div class="section" id="section3">
            <div class="gift-box" onclick="openGift(3)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content3">
                <h2>üíô Peluche Tristeza</h2>
                <p>"Se parece a Tristeza‚Ä¶ pero t√∫ eres mi Alegr√≠a."</p>
                <button class="btn" onclick="nextSection(4)">Siguiente ‚ûú</button>
            </div>
        </div>

        <div class="section" id="section4">
            <div class="gift-box" onclick="openGift(4)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content4">
                <h2>‚ôæÔ∏è R√©plica Botella Klein</h2>
                <p>"Lo nuestro no tiene principio ni fin."</p>
                <button class="btn" onclick="nextSection(5)">Siguiente ‚ûú</button>
            </div>
        </div>

        <div class="section" id="section5">
            <div class="gift-box" onclick="openGift(5)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content5">
                <h2>üëô Calz√≥n</h2>
                <p>"Que no se pierda la costumbre de modelar‚Ä¶ mi obra favorita."</p>
                <button class="btn" onclick="nextSection(6)">Siguiente ‚ûú</button>
            </div>
        </div>

        <div class="section" id="section6">
            <div class="gift-box" onclick="openGift(6)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content6">
                <h2>‚ú® Crema Tono Natural</h2>
                <p>"Para cuidar tu piel‚Ä¶ aunque ya iluminas todo."</p>
                <button class="btn" onclick="nextSection(7)">Siguiente ‚ûú</button>
            </div>
        </div>

        <div class="section" id="section7">
            <div class="gift-box" onclick="openGift(7)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content7">
                <h2>üíÉ Baby Doll</h2>
                <p>"Espero te quede perfecto‚Ä¶ aunque perfecta ya eres t√∫."</p>
                <button class="btn" onclick="nextSection(8)">Siguiente ‚ûú</button>
            </div>
        </div>

        <div class="section" id="section8">
            <div class="gift-box" onclick="openGift(8)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content8">
                <h2>üß≤ Calcetas Im√°n</h2>
                <p>"Siempre terminamos juntos, aunque nos soltemos tantito."</p>
                <button class="btn" onclick="nextSection(9)">Siguiente ‚ûú</button>
            </div>
        </div>

        <div class="section" id="section9">
            <div class="gift-box" onclick="openGift(9)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content9">
                <h2>üíÖ Isdin Nails</h2>
                <p>"Para que tus u√±as crezcan‚Ä¶ y me sigas marcando el coraz√≥n."</p>
                <button class="btn" onclick="nextSection(10)">Siguiente ‚ûú</button>
            </div>
        </div>

        <div class="section" id="section10">
            <div class="gift-box" onclick="openGift(10)">
                <div class="gift-box-container">
                    <div class="gift-base"></div>
                    <div class="gift-lid">
                        <div class="gift-ribbon-v"></div>
                        <div class="gift-ribbon-h"></div>
                        <div class="gift-bow"></div>
                    </div>
                </div>
            </div>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-top: 20px; opacity: 0.8;">Toca para abrir üéÅ</p>
            <div class="gift-content" id="content10">
                <h2>üìñ Libro Carpe Diem</h2>
                <p>"Contigo quiero vivir el presente‚Ä¶ una y otra vez."</p>
                <button class="btn" onclick="nextSection(11)">Siguiente ‚ûú</button>
            </div>
        </div>

        <!-- Secci√≥n 11: Mini Juego -->
        <div class="section" id="section11">
            <h2 style="margin-bottom: 20px; font-size: clamp(1.5rem, 6vw, 2.5rem);">Nivel Final: Mini Juego üíò</h2>
            <p style="font-size: clamp(1rem, 4vw, 1.3rem); margin-bottom: 20px; text-align: center;">¬°Atrapa 12 corazones en 20 segundos!</p>
            <div class="game-container" id="gameContainer">
                <div class="game-stats">
                    <div class="game-stat">‚ù§Ô∏è <span id="score">0</span>/12</div>
                    <div class="game-stat">‚è±Ô∏è <span id="timer">20</span>s</div>
                </div>
            </div>
            <div id="gameResult" style="display: none;">
                <div class="game-result" id="resultText"></div>
                <button class="btn" id="gameActionBtn" style="animation: none; opacity: 1;"></button>
            </div>
        </div>

        <!-- Secci√≥n 12: Final -->
        <div class="section" id="section12">
            <h1 style="font-size: clamp(2rem, 8vw, 4rem); margin-bottom: 30px;">Lidy‚Ä¶</h1>
            <p style="font-size: clamp(1.3rem, 5vw, 2.2rem); line-height: 1.8; text-align: center; max-width: 90%; margin-bottom: 20px;">
                Tu sonrisa me enamora‚Ä¶<br>
                pero tu energ√≠a me enciende.
            </p>
            <h2 style="font-size: clamp(1.8rem, 7vw, 3.5rem); margin: 30px 0; text-shadow: 0 0 30px rgba(255, 20, 147, 0.9);">
                Feliz 14 de febrero ‚ù§Ô∏èüî•
            </h2>
            <button class="btn" onclick="restart()" style="animation: none; opacity: 1; margin-top: 30px;">Repetir experiencia ‚Üª</button>
        </div>
    </div>

    <!-- Audio -->
    <audio id="bgMusic" loop>
        <source src="track.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Variables globales
        let currentSection = 0;
        let audio = document.getElementById('bgMusic');
        let audioControl = document.getElementById('audioControl');
        let isMuted = false;
        let gameInterval = null;
        let gameTimer = null;
        let score = 0;
        let timeLeft = 20;
        const totalSections = 12;

        // Inicializar barra de progreso
        function initProgressBar() {
            const progressBar = document.getElementById('progressBar');
            for (let i = 0; i <= totalSections; i++) {
                const dot = document.createElement('div');
                dot.className = 'progress-dot';
                dot.id = `dot${i}`;
                progressBar.appendChild(dot);
            }
            document.getElementById('dot0').classList.add('active');
        }

        // Actualizar progreso
        function updateProgress(section) {
            for (let i = 0; i <= totalSections; i++) {
                const dot = document.getElementById(`dot${i}`);
                if (dot) {
                    dot.classList.toggle('active', i === section);
                }
            }
        }

        // Intentar entrar en fullscreen
        function tryFullscreen() {
            const elem = document.documentElement;
            try {
                if (elem.requestFullscreen) {
                    elem.requestFullscreen().catch(() => {});
                } else if (elem.webkitRequestFullscreen) {
                    elem.webkitRequestFullscreen().catch(() => {});
                } else if (elem.msRequestFullscreen) {
                    elem.msRequestFullscreen().catch(() => {});
                }
            } catch (e) {
                // Fullscreen no soportado o bloqueado
            }
            
            // Simular fullscreen en iOS
            document.body.style.position = 'fixed';
            document.body.style.width = '100%';
            document.body.style.height = '100dvh';
            window.scrollTo(0, 0);
        }

        // Iniciar audio
        function startAudio() {
            try {
                audio.play().then(() => {
                    audioControl.style.display = 'flex';
                }).catch(err => {
                    console.log('Audio play failed:', err);
                    showAudioStatus('Toca para iniciar m√∫sica üéµ');
                    document.body.addEventListener('click', function tryPlay() {
                        audio.play().then(() => {
                            audioControl.style.display = 'flex';
                            hideAudioStatus();
                            document.body.removeEventListener('click', tryPlay);
                        }).catch(() => {});
                    }, { once: true });
                });
            } catch (e) {
                showAudioStatus('Error al cargar m√∫sica');
            }
        }

        // Mostrar estado de audio
        function showAudioStatus(message) {
            const status = document.getElementById('audioStatus');
            status.textContent = message;
            status.style.display = 'block';
        }

        function hideAudioStatus() {
            document.getElementById('audioStatus').style.display = 'none';
        }

        // Control de audio (mute/unmute)
        audioControl.addEventListener('click', () => {
            isMuted = !isMuted;
            audio.muted = isMuted;
            audioControl.textContent = isMuted ? 'üîá' : 'üîä';
            vibrate(50);
        });

        // Pausar audio cuando cambia de pesta√±a
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                audio.pause();
            } else {
                if (!isMuted) {
                    audio.play().catch(() => {});
                }
            }
        });

        // Iniciar experiencia
        function startExperience() {
            tryFullscreen();
            startAudio();
            nextSection(1);
            vibrate(100);
        }

        // Cambiar de secci√≥n
        function nextSection(section) {
            document.getElementById(`section${currentSection}`).classList.remove('active');
            currentSection = section;
            document.getElementById(`section${section}`).classList.add('active');
            updateProgress(section);
            vibrate(50);

            // Si llegamos a la secci√≥n del juego, iniciarlo autom√°ticamente
            if (section === 11) {
                setTimeout(startGame, 1000);
            }
        }

        // Abrir regalo
        function openGift(giftNumber) {
            const giftBox = document.querySelector(`#section${giftNumber} .gift-box`);
            const content = document.getElementById(`content${giftNumber}`);
            
            if (!giftBox.classList.contains('opening')) {
                giftBox.classList.add('opening');
                vibrate([100, 50, 100]);
                
                // Mostrar contenido despu√©s de la animaci√≥n
                setTimeout(() => {
                    giftBox.style.display = 'none';
                    content.classList.add('revealed');
                }, 4000);
            }
        }

        // Mini juego
        function startGame() {
            score = 0;
            timeLeft = 20;
            document.getElementById('score').textContent = score;
            document.getElementById('timer').textContent = timeLeft;
            document.getElementById('gameResult').style.display = 'none';
            
            const container = document.getElementById('gameContainer');
            
            // Generar corazones
            gameInterval = setInterval(() => {
                createHeart(container);
            }, 800);
            
            // Timer
            gameTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function createHeart(container) {
            const heart = document.createElement('div');
            heart.className = 'heart-target';
            heart.textContent = '‚ù§Ô∏è';
            heart.style.left = Math.random() * (container.clientWidth - 50) + 'px';
            heart.style.top = Math.random() * (container.clientHeight - 100) + 50 + 'px';
            
            heart.addEventListener('click', () => {
                score++;
                document.getElementById('score').textContent = score;
                createExplosion(heart);
                heart.remove();
                vibrate(30);
                
                if (score >= 12) {
                    endGame();
                }
            });
            
            container.appendChild(heart);
            
            // Remover coraz√≥n despu√©s de 3 segundos
            setTimeout(() => {
                if (heart.parentNode) {
                    heart.remove();
                }
            }, 3000);
        }

        function createExplosion(element) {
            const rect = element.getBoundingClientRect();
            for (let i = 0; i < 5; i++) {
                const particle = document.createElement('div');
                particle.className = 'heart-explosion';
                particle.textContent = 'üíñ';
                particle.style.left = rect.left + rect.width / 2 + 'px';
                particle.style.top = rect.top + rect.height / 2 + 'px';
                particle.style.fontSize = '20px';
                document.body.appendChild(particle);
                
                setTimeout(() => particle.remove(), 600);
            }
        }

        function endGame() {
            clearInterval(gameInterval);
            clearInterval(gameTimer);
            
            // Limpiar corazones restantes
            const hearts = document.querySelectorAll('.heart-target');
            hearts.forEach(heart => heart.remove());
            
            const resultDiv = document.getElementById('gameResult');
            const resultText = document.getElementById('resultText');
            const actionBtn = document.getElementById('gameActionBtn');
            
            resultDiv.style.display = 'block';
            
            if (score >= 12) {
                resultText.innerHTML = '¬°Incre√≠ble! üéâ<br>Eres tan r√°pida como hermosa üòè';
                actionBtn.textContent = 'Continuar ‚ûú';
                actionBtn.onclick = () => nextSection(12);
                vibrate([100, 50, 100, 50, 100]);
            } else {
                resultText.innerHTML = `¬°Casi! Atrapaste ${score}/12 ‚ù§Ô∏è<br>Pero no te preocupes... me atrapaste a m√≠ üòò`;
                actionBtn.textContent = 'Reintentar üîÑ';
                actionBtn.onclick = () => {
                    document.getElementById('gameResult').style.display = 'none';
                    startGame();
                };
                vibrate(200);
            }
        }

        // Vibraci√≥n (si est√° disponible)
        function vibrate(pattern) {
            if ('vibrate' in navigator) {
                navigator.vibrate(pattern);
            }
        }

        // Reiniciar experiencia
        function restart() {
            // Limpiar juego si est√° activo
            if (gameInterval) clearInterval(gameInterval);
            if (gameTimer) clearInterval(gameTimer);
            
            // Resetear todas las cajas de regalo
            for (let i = 1; i <= 10; i++) {
                const giftBox = document.querySelector(`#section${i} .gift-box`);
                const content = document.getElementById(`content${i}`);
                if (giftBox) {
                    giftBox.classList.remove('opening');
                    giftBox.style.display = 'block';
                }
                if (content) {
                    content.classList.remove('revealed');
                }
            }
            
            // Volver al inicio
            document.getElementById(`section${currentSection}`).classList.remove('active');
            currentSection = 0;
            document.getElementById('section0').classList.add('active');
            updateProgress(0);
            vibrate(100);
        }

        // Canvas de part√≠culas
        function initParticles() {
            const canvas = document.getElementById('particles');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const particles = [];
            const particleCount = 50;
            
            class Particle {
                constructor() {
                    this.reset();
                }
                
                reset() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 3 + 1;
                    this.speedX = Math.random() * 1 - 0.5;
                    this.speedY = Math.random() * 1 - 0.5;
                    this.opacity = Math.random() * 0.5 + 0.2;
                }
                
                update() {
                    this.x += this.speedX;
                    this.y += this.speedY;
                    
                    if (this.x > canvas.width || this.x < 0 || this.y > canvas.height || this.y < 0) {
                        this.reset();
                    }
                }
                
                draw() {
                    ctx.fillStyle = `rgba(255, 105, 180, ${this.opacity})`;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
            
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(particle => {
                    particle.update();
                    particle.draw();
                });
                requestAnimationFrame(animate);
            }
            
            animate();
            
            // Redimensionar canvas
            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
        }

        // Inicializar todo al cargar
        window.addEventListener('load', () => {
            initProgressBar();
            initParticles();
        });

        // Prevenir zoom accidental en iOS
        document.addEventListener('gesturestart', e => e.preventDefault());
        document.addEventListener('touchmove', e => {
            if (e.scale !== 1) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>